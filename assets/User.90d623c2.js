import{t as o}from"./tableFlow.31edb31e.js";import{d as c}from"./datePicker.1a087a29.js";import m from"./Order.5e3f3025.js";import u from"./Wallet.e2a61763.js";import{n as p}from"./index.621e7bf7.js";import"./vendor.c31495b0.js";import"./WalletTrade.db3e0ccf.js";import"./WalletDetail.cc6fc8dd.js";var d=function(){var r=this,e=this,i=e.$createElement,t=e._self._c||i;return t("el-row",[t("el-col",{attrs:{span:24}},[t("k-search-card",{scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{directives:[{name:"throttle",rawName:"v-throttle"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.getUserList()}}},[e._v("\u67E5\u8BE2")]),t("el-button",{directives:[{name:"throttle",rawName:"v-throttle"}],attrs:{size:"mini"},on:{click:function(a){e.resetQuery(),e.dateTime=[],e.getUserList()}}},[e._v("\u91CD\u7F6E")])]},proxy:!0}])},[t("el-form",{staticStyle:{display:"flex","flex-flow":"row wrap",gap:"10px"},attrs:{inline:!0,size:"small"},nativeOn:{submit:function(a){a.preventDefault()}}},[t("el-form-item",{attrs:{label:"\u624B\u673A\u53F7"}},[t("el-input",{model:{value:e.query.mobile,callback:function(a){e.$set(e.query,"mobile",a)},expression:"query.mobile"}})],1),t("el-form-item",{attrs:{label:"\u6635\u79F0"}},[t("el-input",{attrs:{maxlength:"32"},model:{value:e.query.nickname,callback:function(a){e.$set(e.query,"nickname",a)},expression:"query.nickname"}})],1),t("el-form-item",{attrs:{label:"\u9009\u62E9\u65F6\u95F4"}},[t("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4",align:"right","value-format":"timestamp"},model:{value:e.dateTime,callback:function(a){e.dateTime=a},expression:"dateTime"}})],1)],1)],1),t("k-table",{attrs:{"table-name":"\u7528\u6237\u6570\u636E",headers:e.headers,data:e.data,"is-pagination":"",total:e.total,loading:e.loading,toolbar:"",reload:e.getUserList},on:{changePage:function(a){r.page=a,r.getUserList()},"sort-change":function(a){r.sortHandle(a),r.getUserList()}},scopedSlots:e._u([{key:"item.gender",fn:function(a){var s=a.scope;return[s.row.gender===0?t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("\u672A\u77E5")]):e._e(),s.row.gender===1?t("el-tag",{attrs:{size:"mini",type:"primary"}},[e._v("\u7537")]):e._e(),s.row.gender===2?t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("\u5973")]):e._e()]}},{key:"item.avatar",fn:function(a){var s=a.scope;return[s.row.avatar?t("el-image",{staticClass:"table-logo",attrs:{src:e.$config.staticUrl()+s.row.avatar,lazy:"",fit:"contain",previewSrcList:[e.$config.staticUrl()+s.row.avatar]}}):e._e()]}},{key:"item.city",fn:function(a){var s=a.scope;return[t("span",[e._v(e._s(s.row.province+"/"+s.row.city))])]}},{key:"item.sum_amount",fn:function(a){var s=a.scope;return[t("el-tag",{attrs:{type:s.row.sum_amount?"success":"info",size:"mini"}},[e._v(e._s(s.row.sum_amount?s.row.sum_amount:0))])]}},{key:"item.wallet",fn:function(a){var s=a.scope;return[s.row.wallet?t("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"hover"}},[t("div",[t("div",{staticClass:"list-item"},[t("span",[e._v("\u94B1\u5305\u4F59\u989D")]),t("span",[e._v(e._s(s.row.wallet.balance))])]),t("div",{staticClass:"list-item"},[t("span",[e._v("\u603B\u6536\u5165\u91D1\u989D")]),t("span",[e._v(e._s(s.row.wallet.income_amount))])]),t("div",{staticClass:"list-item"},[t("span",[e._v("\u603B\u652F\u51FA\u91D1\u989D")]),t("span",[e._v(e._s(s.row.wallet.outcome_amount))])]),t("div",{staticClass:"list-item"},[t("span",[e._v("\u51BB\u7ED3\u91D1\u989D")]),t("span",[e._v(e._s(s.row.wallet.frozen_amount))])])]),t("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},on:{click:function(n){e.selectItem=s.row,e.drawerWallet.visible=!0}},slot:"reference"},[e._v(e._s(s.row.wallet.balance))])]):e._e()]}},{key:"item.order",fn:function(a){var s=a.scope;return[t("el-button",{staticClass:"smini-btn",attrs:{size:"mini",type:"primary",plain:""},on:{click:function(n){e.selectItem=s.row,e.drawer.visible=!0}}},[e._v("\u67E5\u770B\u8BA2\u5355")])]}},{key:"item.action",fn:function(a){var s=a.scope;return[t("el-button",{staticClass:"smini-btn",attrs:{size:"mini",type:"warning",plain:""},on:{click:function(n){return e.logout(s.row)}}},[e._v(" \u5F3A\u5236\u767B\u51FA ")]),s.row.status===1?t("el-button",{staticClass:"smini-btn",attrs:{size:"mini",type:"danger",plain:""},on:{click:function(n){return e.disabledUser(s.row)}}},[e._v(" \u7981\u7528\u7528\u6237 ")]):e._e(),s.row.status===0?t("el-button",{staticClass:"smini-btn",attrs:{size:"mini",type:"success",plain:""},on:{click:function(n){return e.switchStatus("status",1,s.row)}}},[e._v("\u542F\u7528\u7528\u6237")]):e._e()]}}])})],1),t("k-drawer",{attrs:{visible:e.drawer.visible,title:(e.selectItem.nickname?e.selectItem.nickname:e.selectItem.mobile)+"/\u7528\u6237\u8BA2\u5355",size:"55%","destroy-on-close":""},on:{"update:visible":function(a){return e.$set(e.drawer,"visible",a)}}},[t("order",{attrs:{"is-component":"","user-mobile":e.selectItem.mobile}})],1),t("k-drawer",{attrs:{visible:e.drawerWallet.visible,title:(e.selectItem.nickname?e.selectItem.nickname:e.selectItem.mobile)+"/\u7528\u6237\u94B1\u5305",size:"55%","destroy-on-close":""},on:{"update:visible":function(a){return e.$set(e.drawerWallet,"visible",a)}}},[t("wallet",{attrs:{"is-component":"",mobile:e.selectItem.mobile}})],1)],1)},v=[];const _={name:"User",components:{Wallet:u,Order:m},mixins:[o,c],data(){return{drawerWallet:{visible:!1,title:""},headers:[{label:"id",prop:"id"},{label:"\u624B\u673A\u53F7",prop:"mobile"},{label:"\u6635\u79F0",prop:"nickname",tooltip:!0},{label:"\u6027\u522B",prop:"gender",func:r=>r.gender===1?"\u7537":r.gender===2?"\u5973":"\u672A\u77E5"},{label:"\u5934\u50CF",prop:"avatar"},{label:"\u6240\u5728\u5730",prop:"city"},{label:"\u6D88\u8D39\u91D1\u989D",prop:"sum_amount",sortable:"custom",func:r=>r.sum_amount?r.sum_amount:0},{label:"\u94B1\u5305\u4F59\u989D",prop:"wallet",func:r=>r.wallet.balance},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"created_at",type:"date"},{label:"\u767B\u5F55\u65F6\u95F4",prop:"login_time",type:"date"},{label:"\u7528\u6237\u8BA2\u5355",prop:"order",export:!1},{label:"\u64CD\u4F5C",prop:"action",width:160}],data:[],query:{nickname:null,mobile:null,start_time:null,end_time:null}}},mounted(){this.getUserList()},methods:{async getUserList(){this.loading=!0;try{this.dateTime.length!==0&&(this.query.start_time=this.dateTime[0]/1e3,this.query.end_time=this.dateTime[1]/1e3);let r=this.queryMerge(),e=await this.$api.user.batchQuery(r);this.data=e.data.data,this.total=e.data.total}catch{}finally{this.loading=!1}},async disabledUser(r){this.$tool.confirmWarning(`\u786E\u5B9A\u8981\u7981\u7528${r.nickname?r.nickname:r.mobile}\u8FD9\u4E2A\u7528\u6237\u5417\uFF1F`).then(()=>{this.switchStatus("status",0,r)}).catch(()=>{})},async logout(r){this.$tool.confirmWarning(`\u786E\u5B9A\u8981\u5F3A\u5236\u9000\u51FA\u6B64${r.nickname?r.nickname:r.mobile}\u8FD9\u4E2A\u7528\u6237\u5417\uFF1F\u53EF\u80FD\u4F1A\u4E2D\u65AD\u5F53\u524D\u7528\u6237\u64CD\u4F5C!`).then(()=>{this.$api.user.logout({id:r.id}).then(e=>{this.$message.success("\u64CD\u4F5C\u6210\u529F")})}).catch(()=>{})},async switchStatus(r,e,i){let t={id:i.id};t[r]=e,this.$api.user.disable(t).then(a=>{i[r]=e,this.$message.success("\u66F4\u65B0\u6210\u529F")}).catch(a=>{i.status=e===0?1:0})}}},l={};var f=p(_,d,v,!1,b,"dace20c6",null,null);function b(r){for(let e in l)this[e]=l[e]}var U=function(){return f.exports}();export{U as default};
